import{_ as $,e as S,u as q,n as N,o as _,c as y,a as e,a0 as p,q as f,b as v,k as R,I as V,p as T,d as w,r as D,$ as Q,m as j,w as g,h as b,ad as E,L as F,T as G,i as H,j as U,l as z,N as L,ae as J}from"./index.54d239d6.js";/* empty css              */import{_ as K}from"./back.15982f8f.js";import{Q as M}from"./QHead.261cc03b.js";import{l as O,n as W,_ as X}from"./notlike.13269c64.js";const x=t=>(T("data-v-0662a669"),t=t(),w(),t),Y={class:"reply"},Z={class:"content"},ee={class:"main"},te={class:"footer"},se=["src"],oe=x(()=>e("span",null,[e("img",{src:X,alt:"\u65F6\u95F4"})],-1)),ne=x(()=>e("div",{class:"deco"},null,-1)),ie={__name:"Reply",props:{content:{type:String,required:!0},id:{type:Number,required:!0},isLiked:{type:Boolean,required:!0},isPublished:{type:Boolean,required:!0},likeCount:{type:Number,default:0},createTime:{type:String,required:!0},userId:{type:Number,required:!0}},emits:{like(t,l,d,u){return d.state.login?d.state.login:(Notify({type:"warning",message:"\u672A\u767B\u5F55\uFF0C\u524D\u5F80\u767B\u5F55"}),u.push("/form/login"),!1)},delete(t,l){return l}},setup(t,{emit:l}){const d=t,u=S(),h=q(),k=N(()=>d.isLiked?O:W);return(s,r)=>{const I=V;return _(),y("div",Y,[e("div",Z,[e("p",ee,p(t.content),1),e("p",te,[e("span",null,[e("img",{src:f(k),alt:"\u70B9\u8D5E",onClick:r[0]||(r[0]=()=>l("like",t.id,t.userId,f(u),f(h)))},null,8,se)]),e("span",null,p(t.likeCount),1),oe,e("span",null,p(t.createTime),1)])]),ne,t.isPublished?(_(),y("div",{key:0,class:"delete",onClick:r[1]||(r[1]=()=>l("delete",t.id,t.isPublished))},[v(I,{name:"cross"})])):R("",!0)])}}},ae=$(ie,[["__scopeId","data-v-0662a669"]]);const C=t=>(T("data-v-5a2c4108"),t=t(),w(),t),le=C(()=>e("img",{src:K,alt:"\u8FD4\u56DE\u6309\u94AE\u4E2D\u7684\u4E00\u5F20\u56FE\u7247"},null,-1)),ce=[le],de=C(()=>e("span",{class:"middle-title"}," \u89E3\u6E58 ",-1)),ue={class:"question-desc"},re={class:"content"},me={class:"title"},_e={class:"desc"},pe=C(()=>e("div",{class:"deco"},null,-1)),fe={__name:"Ans",setup(t){const l=D(!1),d=q(),u=Q(),h=S(),{postId:k}=u.params,s=j({title:"",content:"",list:[],offset:0,limit:6,ansCount:null}),r=N(()=>s.ansCount!==null&&s.offset*s.limit>s.ansCount),I=async()=>{try{const o=await E(k,s.offset,s.limit);console.log("res-->",o);const a=o[o.length-1];s.ansCount=a.discussPost.commentCount,s.title||(s.title=a.discussPost.title,s.content=a.discussPost.content);const i=[];for(let m=0;m<o.length-1;++m){const c=o[m];i.push({content:c.comment.content,createTime:c.comment.createTime.substr(0,10),id:c.comment.id,isPublished:h.state.login&&h.state.userId===c.comment.userId,isLiked:c.likeStatus!==0,likeCount:c.likeCount,userId:c.comment.userId})}console.log("res",o),console.log("list",i);const n=setTimeout(()=>{clearTimeout(n),s.offset+=1,s.list.push(...i),l.value=!1},1500)}catch(o){console.log(o)}},P=async(o,a)=>{try{const i=await z(k,2,o,a),n=i.likeStatus===1?"\u70B9\u8D5E\u6210\u529F":"\u53D6\u6D88\u70B9\u8D5E\u6210\u529F",m=s.list.find(c=>c.id===o);m.isLiked=i.likeStatus===1,m.likeCount=i.likeCount,L({type:"success",message:n})}catch(i){console.log(i)}},A=async o=>{const a=await J(o);console.log("delete res",a),s.list=s.list.filter(i=>i.id!==o),L({type:"success",message:"\u5220\u9664\u6210\u529F"})},B=async()=>{d.push(`/ans-question/${u.params.postId}`)};return(o,a)=>{const i=F;return _(),y(b,null,[e("header",null,[v(M,{class:"head"},{left:g(()=>[e("div",{class:"back",onClick:a[0]||(a[0]=()=>f(d).go(-1))},ce)]),middle:g(()=>[de]),_:1}),e("div",ue,[e("div",re,[e("h2",me,p(s.title),1),e("div",_e,p(s.content),1)]),pe])]),e("main",null,[v(i,{"finished-text":"\u6CA1\u6709\u66F4\u591A\u4E86",onLoad:I,loading:l.value,"onUpdate:loading":a[1]||(a[1]=n=>l.value=n),finished:f(r)},{default:g(()=>[v(G,{name:"list"},{default:g(()=>[(_(!0),y(b,null,H(s.list,n=>(_(),U(ae,{content:n.content,"create-time":n.createTime,"is-liked":n.isLiked,id:n.id,"is-published":n.isPublished,"like-count":n.likeCount,key:n.id,userId:n.userId,class:"reply-item",onLike:P,onDelete:A},null,8,["content","create-time","is-liked","id","is-published","like-count","userId"]))),128))]),_:1})]),_:1},8,["loading","finished"]),e("button",{class:"add",onClick:B},"+")])],64)}}},Ie=$(fe,[["__scopeId","data-v-5a2c4108"]]);export{Ie as default};
